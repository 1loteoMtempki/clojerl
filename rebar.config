{ erl_opts
, [ debug_info
  , {platform_define, "^2", 'ETS_CAS'}
  , {platform_define, "^(R|1|20)", 'FUN_STACKTRACE'}
  ]
}.

{src_dirs, ["src", "bootstrap"]}.

{clje_src_dirs,  ["src/clj"]}.
{clje_test_dirs, ["test/clj"]}.
{clje_compile_first, ["clojure/core.clje"]}.
{ clje_exclude
, [ "clojure/core_print.clje"
  , "clojure/core_deftype.clje"
  , "clojure/core/protocols.clje"
  , "clojure/instant.clje"
  , "clojure/uuid.clje"

  , "clojure/pprint/cl_format.clje"
  , "clojure/pprint/column_writer.clje"
  , "clojure/pprint/dispatch.clje"
  , "clojure/pprint/pprint_base.clje"
  , "clojure/pprint/pretty_writer.clje"
  , "clojure/pprint/print_table.clje"
  , "clojure/pprint/utilities.clje"
  ]
}.

{cover_enabled, true}.
{shell, [{apps, [clojerl]}]}.

{ provider_hooks
, [{post, [{compile, {clojerl, compile}}]}]
}.

{ plugins
, [ { rebar3_clojerl
    , {git, "https://github.com/clojerl/rebar3_clojerl", {tag, "0.1.0"}}
    }
  ]
}.

{ profiles,
  [ { dev
    , [ { deps
        , [{eflame, ".*", {git, "https://github.com/jfacorro/eflame", {branch, "various.improvements"}}}]
        }
      ]
    }
  , { test
    , [ {src_dirs, ["src", "bootstrap", "scripts"]}
      , { deps
        , [ {xref_runner, {git, "https://github.com/inaka/xref_runner.git", {tag, "0.2.5"}}}
          , {meck,        {git, "https://github.com/eproxus/meck",          {tag, "0.8.10"}}}
          ]
        }
      , { plugins
        , [ covertool
          , { cover_result
            , {git,  "https://github.com/jfacorro/cover_result", {tag, "0.1.0"}}
            }
          ]
        }
      ]
    }
  ]
}.
